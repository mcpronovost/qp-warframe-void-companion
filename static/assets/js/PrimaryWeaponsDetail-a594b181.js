import{d as I,u as V,s as H,a as G,r as y,o as J,f as e,g as n,h as g,w as h,i as o,j as K,c as C,t as _,k as Q,n as X,F as k,l as q,M as Y,A as R,H as S,E as v,N as U,e as m,m as Z,v as ee,D as te,p as se,_ as ne}from"./index-13251ea8.js";import{_ as oe}from"./WeaponImage.vue_vue_type_script_setup_true_lang-b9aabe63.js";import"./systems-5ba34008.js";const ae={key:0,class:"qp-container"},le={class:"qp-weapons-actions"},re={class:"qp-weapons-actions-extra"},ie=["textContent"],pe=["textContent"],ce={class:"qp-weapons-detail-components-list"},ue=["onClick"],de={class:"qp-weapons-detail-components-item-wrapper"},_e={class:"qp-weapons-detail-components-img"},me={class:"qp-weapons-detail-components-name"},he=["textContent"],ve={class:"qp-weapons-detail-components-relics"},fe={key:0},we={key:1,class:"qp-weapons-detail-components-era"},ye=["textContent"],ge={key:0},Ce={key:1,class:"qp-weapons-detail-components-era"},ke=["textContent"],qe={key:0},$e={key:1,class:"qp-weapons-detail-components-era"},xe=["textContent"],Ee={key:0},De={key:1,class:"qp-weapons-detail-components-era"},be=["textContent"],Ae={class:"qp-weapons-detail-image"},Re=I({__name:"PrimaryWeaponsDetail",setup(Se){const{t:u}=V(),L=ee(),P=te(),z=H(),{rat:$,lang:D}=G(z),f=y(!1),d=y(!1),b=y(null),x=y(null),p=y(),A=async(r=!1)=>{r||(f.value=!0),b.value=null;try{let t=await fetch(`${R}/primary-weapons/${L.params.pk}/`,{method:"GET",headers:S($.value,D.value)}).then(a=>a).catch(()=>new Response(null,{status:400}));if(t.status===200){let a=await t.json();p.value=a,f.value=!1}else throw t.status}catch(t){t===401?v.error("not authorized"):v.error(u("AnErrorOccurred")),b.value=`${t}`,f.value=!1}},W=async(r,t=!1)=>{d.value=!0,x.value=null;let a=new FormData;p.value&&t?a.append("id",p.value.components.map(s=>s.id.toString()).join(",")):a.append("id",r.toString());try{let s=await fetch(`${R}/me/primary-weapons/components/create/`,{method:"POST",body:a,headers:S($.value,D.value)}).then(w=>w).catch(()=>new Response(null,{status:400}));if(s.status===201)U({message:u(t?"ComponentsUpdated":"ComponentUpdated"),type:"success",position:"bottom-right",showClose:!0}),d.value=!1,t?P.push({name:"PrimaryWeapons"}):A(!0);else throw s.status}catch(s){s===401?v.error("not authorized"):v.error(u("AnErrorOccurred")),x.value=`${s}`,d.value=!1}},N=async(r,t=!1)=>{d.value=!0,x.value=null;let a=new FormData;p.value&&t&&a.append("ids",p.value.components.map(s=>s.id.toString()).join(","));try{let s=await fetch(`${R}/me/primary-weapons/components/${r}/delete/`,{method:"DELETE",body:a,headers:S($.value,D.value)}).then(w=>w).catch(()=>new Response(null,{status:400}));if(s.status===204)U({message:u(t?"ComponentsUpdated":"ComponentUpdated"),type:"success",position:"bottom-right",showClose:!0}),d.value=!1,A(!0);else throw s.status}catch(s){s===401?v.error("not authorized"):v.error(u("AnErrorOccurred")),x.value=`${s}`,d.value=!1}},E=(r,t)=>{let a=r.filter(s=>s.era==t);return a!=null&&a.length?a:[]};return J(()=>{A()}),(r,t)=>{const a=m("qp-header"),s=m("el-button"),w=m("el-button-group"),O=m("el-col"),B=m("el-row"),F=m("qp-notfound"),M=m("qp-loading"),j=Z("loading");return!f.value&&!b.value&&p.value?(e(),n("div",ae,[g(a,{title:p.value.name,"page-type":"weapon"},null,8,["title"]),g(B,{class:"qp-weapons-detail"},{default:h(()=>[g(O,{span:24,md:14,class:"qp-weapons-detail-info"},{default:h(()=>[o("div",le,[o("div",re,[K($)?(e(),C(w,{key:0},{default:h(()=>[p.value.completion<100?(e(),C(s,{key:0,onClick:t[0]||(t[0]=l=>W(0,!0))},{default:h(()=>[o("span",{textContent:_(r.$t("CompleteAll"))},null,8,ie)]),_:1})):(e(),C(s,{key:1,onClick:t[1]||(t[1]=l=>N(0,!0))},{default:h(()=>[o("span",{textContent:_(r.$t("RemoveAll"))},null,8,pe)]),_:1}))]),_:1})):Q("",!0)])]),X((e(),n("ul",ce,[(e(!0),n(k,null,q(p.value.components,(l,T)=>(e(),n("li",{key:`weapon-components-${T}`,class:se(`qp-weapons-detail-components-item${l.is_owned?" qp-isowned":""}`),onClick:c=>l.is_owned?N(l.id):W(l.id)},[o("div",de,[o("div",_e,[g(oe,{component:l.name},null,8,["component"])]),o("div",null,[o("div",me,[o("span",{textContent:_(r.$t(l.name))},null,8,he)]),o("div",ve,[o("div",null,[(e(!0),n(k,null,q(E(l.relics,"Lith"),(c,i)=>(e(),n("span",{key:`component-relics-${i}`},[i>0?(e(),n("span",fe,", ")):(e(),n("span",we,"Lith : ")),o("span",{textContent:_(c.name)},null,8,ye)]))),128))]),o("div",null,[(e(!0),n(k,null,q(E(l.relics,"Meso"),(c,i)=>(e(),n("span",{key:`component-relics-${i}`},[i>0?(e(),n("span",ge,", ")):(e(),n("span",Ce,"Meso : ")),o("span",{textContent:_(c.name)},null,8,ke)]))),128))]),o("div",null,[(e(!0),n(k,null,q(E(l.relics,"Neo"),(c,i)=>(e(),n("span",{key:`component-relics-${i}`},[i>0?(e(),n("span",qe,", ")):(e(),n("span",$e,"Neo : ")),o("span",{textContent:_(c.name)},null,8,xe)]))),128))]),o("div",null,[(e(!0),n(k,null,q(E(l.relics,"Axi"),(c,i)=>(e(),n("span",{key:`component-relics-${i}`},[i>0?(e(),n("span",Ee,", ")):(e(),n("span",De,"Axi : ")),o("span",{textContent:_(c.name)},null,8,be)]))),128))])])])])],10,ue))),128))])),[[j,d.value]])]),_:1}),g(O,{span:24,md:10,class:"qp-weapons-detail-picture"},{default:h(()=>[o("div",Ae,[o("div",{class:"qp-weapons-detail-img",style:Y(`background-image:url('https://raw.githubusercontent.com/WFCD/warframe-items/master/data/img/${p.value.image_name}')`)},null,4)])]),_:1})]),_:1})])):f.value?(e(),C(M,{key:2})):(e(),C(F,{key:1}))}}});const Ue=ne(Re,[["__scopeId","data-v-e6da61f0"]]);export{Ue as default};

import{d as H,u as N,r as h,x as P,g as b,c as y,w as l,i as o,j as m,t as q,q as w,y as K,z as J,B as W,C as S,m as A,e as B,D as Y,G as C,A as O,f as n,I as ee,J as te,_ as D,s as Q,K as oe,a as le,o as se,H as ne}from"./index-87a6f656.js";const z=x=>(ee("data-v-0d32003f"),x=x(),te(),x),ae=["textContent"],re=["innerHTML"],ue=["textContent"],ie=["textContent"],de=z(()=>m("div",null,"(en développement)",-1)),pe=z(()=>m("div",null,"(en développement)",-1)),me=z(()=>m("div",null,"(en développement)",-1)),ce=H({__name:"RegisterView",setup(x){const{t:e}=N(),T=B(),c=h(!1),v=h(null),_=h(!1),g=h(!1),$=h(!1),f=h(),r=P({username:"",email:"",name:"",password:"",password_confirm:""}),U=(s,t,a)=>{const p=/^[A-Za-z0-9_-]+$/;t===""?a(new Error(e("Thisfieldisrequired"))):t.match(p)?a():a(new Error(e("Mustonlycontainlettersnumbersandsomecharacters")))},E=(s,t,a)=>{const p=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;t===""?a(new Error(e("Thisfieldisrequired"))):t.match(p)?a():a(new Error(e("Thisemailisinvalid")))},i=(s,t,a)=>{const p=/^[A-Za-z- ]+$/;t===""?a(new Error(e("Thisfieldisrequired"))):t.match(p)?a():a(new Error(e("Mustonlycontainlettersspaceandsomecharacters")))},u=(s,t,a)=>{t===""?a(new Error(e("Thisfieldisrequired"))):t!==r.password?a(new Error(e("Thepasswordconfirmationdoesntmatch"))):a()},L=P({username:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:5,max:150,message:e("LengthshouldbebetweenXandX",[5,150]),trigger:"blur"},{validator:U,trigger:"blur"}],email:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[8,254]),trigger:"blur"},{validator:E,trigger:"blur"}],name:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:2,max:32,message:e("LengthshouldbebetweenXandX",[2,32]),trigger:"blur"},{validator:i,trigger:"blur"}],password:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[6,254]),trigger:"blur"}],password_confirm:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[6,254]),trigger:"blur"},{validator:u,trigger:"blur"}]}),R=async()=>{var s;c.value=!0,v.value=null,await((s=f.value)==null?void 0:s.validate(t=>{t?Y.confirm(C("div",null,[C("p",null,e("Byclickingyouacceptrules")),C("div",{class:"qp-center"},[C("button",{class:"el-button is-text",onClick:()=>{_.value=!0}},e("ReadTheRules"))]),C("div",{class:"qp-center"},[C("button",{class:"el-button is-text",onClick:()=>{g.value=!0}},e("ReadUsePolicies"))]),C("div",{class:"qp-center"},[C("button",{class:"el-button is-text",onClick:()=>{$.value=!0}},e("ReadPrivacyPolicies"))])]),e("Register"),{confirmButtonText:e("IAcceptTheRules"),cancelButtonText:e("Cancel"),autofocus:!1,closeOnClickModal:!1,closeOnPressEscape:!1,closeOnHashChange:!1}).then(()=>{k()}).catch(()=>{c.value=!1}):c.value=!1}))},k=async()=>{c.value=!0,v.value=null;let s=new FormData;s.append("username",r.username.trim()),s.append("email",r.email.trim()),s.append("name",r.name.trim()),s.append("password",r.password);let t=await fetch(`${O}/register/`,{method:"POST",body:s});t.status===200?T.push({name:"AuthLogin"}):t.status===400?(v.value=e("InvalidCredentials"),c.value=!1):(v.value=e("AnErrorOccurred"),c.value=!1)};return(s,t)=>{const a=n("el-input"),p=n("el-form-item"),M=n("el-alert"),V=n("el-button"),j=n("el-form"),F=n("el-card"),X=n("el-scrollbar"),I=n("el-dialog"),Z=n("el-col"),G=n("el-row");return b(),y(G,{id:"qp-auth-register"},{default:l(()=>[o(Z,null,{default:l(()=>[o(F,null,{default:l(()=>[m("h1",{textContent:q(s.$t("Register"))},null,8,ae),o(j,{ref_key:"refRegister",ref:f,model:r,rules:L,"label-position":"top","status-icon":""},{default:l(()=>[o(p,{prop:"username"},{default:l(()=>[o(a,{modelValue:r.username,"onUpdate:modelValue":t[0]||(t[0]=d=>r.username=d),placeholder:s.$t("Username"),"prefix-icon":w(K)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),o(p,{prop:"email"},{default:l(()=>[o(a,{modelValue:r.email,"onUpdate:modelValue":t[1]||(t[1]=d=>r.email=d),placeholder:s.$t("Email"),"prefix-icon":w(J)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),o(p,{prop:"name"},{default:l(()=>[o(a,{modelValue:r.name,"onUpdate:modelValue":t[2]||(t[2]=d=>r.name=d),placeholder:s.$t("PublicName"),"prefix-icon":w(W)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),o(p,{prop:"password"},{default:l(()=>[o(a,{modelValue:r.password,"onUpdate:modelValue":t[3]||(t[3]=d=>r.password=d),placeholder:s.$t("Password"),"prefix-icon":w(S),type:"password"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),o(p,{prop:"password_confirm"},{default:l(()=>[o(a,{modelValue:r.password_confirm,"onUpdate:modelValue":t[4]||(t[4]=d=>r.password_confirm=d),placeholder:s.$t("PasswordConfirm"),"prefix-icon":w(S),type:"password"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),v.value?(b(),y(p,{key:0},{default:l(()=>[o(M,{type:"error","show-icon":"",closable:!1},{default:l(()=>[m("div",{innerHTML:v.value},null,8,re)]),_:1})]),_:1})):A("",!0),o(p,{class:"qp-form-submit"},{default:l(()=>[o(V,{type:"primary",loading:c.value,onClick:t[5]||(t[5]=d=>R())},{default:l(()=>[m("span",{textContent:q(s.$t("RegisterMe"))},null,8,ue)]),_:1},8,["loading"])]),_:1}),o(p,{class:"qp-form-switchauth"},{default:l(()=>[o(V,{text:"",size:"small",disabled:c.value,onClick:t[6]||(t[6]=d=>s.$router.push({name:"AuthLogin"}))},{default:l(()=>[m("span",{textContent:q(s.$t("Alreadyhaveanaccount"))},null,8,ie)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(I,{modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=d=>_.value=d),title:w(e)("TheRules")},{default:l(()=>[o(X,{height:"60vh"},{default:l(()=>[de]),_:1})]),_:1},8,["modelValue","title"]),o(I,{modelValue:g.value,"onUpdate:modelValue":t[8]||(t[8]=d=>g.value=d),title:w(e)("UsePolicies")},{default:l(()=>[o(X,{height:"60vh"},{default:l(()=>[pe]),_:1})]),_:1},8,["modelValue","title"]),o(I,{modelValue:$.value,"onUpdate:modelValue":t[9]||(t[9]=d=>$.value=d),title:w(e)("PrivacyPolicies")},{default:l(()=>[o(X,{height:"60vh"},{default:l(()=>[me]),_:1})]),_:1},8,["modelValue","title"])]),_:1})]),_:1})}}});const _e=D(ce,[["__scopeId","data-v-0d32003f"]]),fe=["textContent"],ge=["innerHTML"],he=["textContent"],ve=["textContent"],we=H({__name:"LoginView",setup(x){const{t:e}=N(),T=B(),c=Q(),{updateRat:v}=c,_=h(!1),g=h(null),$=h(),f=P({username:"",password:""}),r=P({username:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:5,max:150,message:e("LengthshouldbebetweenXandX",[5,150]),trigger:"blur"}],password:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:6,max:254,message:e("LengthshouldbebetweenXandX",[6,254]),trigger:"blur"}]}),U=async()=>{var i;_.value=!0,g.value=null,await((i=$.value)==null?void 0:i.validate(u=>{u?E():_.value=!1}))},E=async()=>{_.value=!0;let i=new FormData;i.append("username",f.username),i.append("password",f.password);let u=await fetch(`${O}/login/`,{method:"POST",body:i});if(u.status===200){let L=await u.json();v(L.token),T.push({name:"Home"})}else u.status===400?(g.value=e("InvalidCredentials"),_.value=!1):(g.value=e("AnErrorOccurred"),_.value=!1)};return(i,u)=>{const L=n("el-input"),R=n("el-form-item"),k=n("el-alert"),s=n("el-button"),t=n("el-form"),a=n("el-card"),p=n("el-col"),M=n("el-row");return b(),y(M,{id:"qp-auth-login"},{default:l(()=>[o(p,null,{default:l(()=>[o(a,null,{default:l(()=>[m("h1",{textContent:q(i.$t("Login"))},null,8,fe),o(t,{ref_key:"refLogin",ref:$,model:f,rules:r,"label-position":"top","status-icon":""},{default:l(()=>[o(R,{prop:"username"},{default:l(()=>[o(L,{modelValue:f.username,"onUpdate:modelValue":u[0]||(u[0]=V=>f.username=V),placeholder:i.$t("Username"),"prefix-icon":w(K)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),o(R,{prop:"password"},{default:l(()=>[o(L,{modelValue:f.password,"onUpdate:modelValue":u[1]||(u[1]=V=>f.password=V),placeholder:i.$t("Password"),"prefix-icon":w(S),type:"password",onKeyup:u[2]||(u[2]=oe(V=>U(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),g.value?(b(),y(k,{key:0,type:"error","show-icon":"",closable:!1},{default:l(()=>[m("p",{innerHTML:g.value},null,8,ge)]),_:1})):A("",!0),o(R,{class:"qp-form-submit"},{default:l(()=>[o(s,{type:"primary",loading:_.value,onClick:u[3]||(u[3]=V=>U())},{default:l(()=>[m("span",{textContent:q(i.$t("LoginMe"))},null,8,he)]),_:1},8,["loading"])]),_:1}),o(R,{class:"qp-form-switchauth"},{default:l(()=>[o(s,{text:"",size:"small",disabled:_.value,onClick:u[4]||(u[4]=V=>i.$router.push({name:"AuthRegister"}))},{default:l(()=>[m("span",{textContent:q(i.$t("Donthaveanaccount"))},null,8,ve)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}});const be=D(we,[["__scopeId","data-v-d1a931fa"]]),ye=["textContent"],$e=["innerHTML"],Ve={class:"qp-form-submit"},Le=["textContent"],Ce=H({__name:"LogoutView",setup(x){const e=B(),T=Q(),{rat:c}=le(T),{cleanUser:v}=T,_=h(!1),g=h(),$=async()=>{_.value=!0,await fetch(`${O}/logout/`,{method:"POST",headers:ne(c.value),body:null}),v(),e.push({name:"Home"})};return se(()=>{$()}),(f,r)=>{const U=n("el-alert"),E=n("el-button"),i=n("el-card"),u=n("el-col"),L=n("el-row");return b(),y(L,{id:"qp-auth-logout"},{default:l(()=>[o(u,null,{default:l(()=>[o(i,{class:"qp-center"},{default:l(()=>[m("h1",{textContent:q(f.$t("Logout"))},null,8,ye),g.value?(b(),y(U,{key:0,type:"error","show-icon":"",closable:!1},{default:l(()=>[m("p",{innerHTML:g.value},null,8,$e)]),_:1})):A("",!0),m("div",Ve,[o(E,{type:"primary",loading:_.value,onClick:r[0]||(r[0]=R=>$())},{default:l(()=>[m("span",{textContent:q(f.$t("LogoutMe"))},null,8,Le)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1})}}});const qe=D(Ce,[["__scopeId","data-v-1e4d5659"]]);const xe={class:"qp-container qp-centered"},Re={__name:"AuthView",setup(x){return(e,T)=>{const c=n("qp-page");return b(),y(c,null,{default:l(()=>[m("div",xe,[e.$route.name&&e.$route.name=="AuthRegister"?(b(),y(_e,{key:0})):e.$route.name&&e.$route.name=="AuthLogin"?(b(),y(be,{key:1})):e.$route.name&&e.$route.name=="AuthLogout"?(b(),y(qe,{key:2})):A("",!0)])]),_:1})}}};export{Re as default};
